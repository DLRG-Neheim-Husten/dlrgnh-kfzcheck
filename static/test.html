<!DOCTYPE html>
<html>

<body>
    <p>
    <div>
        <label for="kennzeichen_eingabe">Kennzeichen eingeben:</label>
        <input type="text" id="kennzeichen_eingabe" value="HSK CK 350">
    </div>

    <div>
        <button id="kennzeichen_abfrage">
            Abschicken
        </button>
    </div>
    </p>
    
    <h3>Ergebnis</h3>
    <p>
    <span id="kennzeichen_ergebnis">
        Ohne Ergebnis
    </span><br>
    <span id="abfragezeitpunkt">unbekannte Uhrzeit</span>
    </p>

    <script>

        var button = document.getElementById('kennzeichen_abfrage');
        button.addEventListener('click', function () {

            var kennzeichen = document.getElementById('kennzeichen_eingabe').getAttribute('value');
            //var url = "https://kfzcheck-dlrgnh.azurewebsites.net/query/" + kennzeichen;
            var url = "http://localhost:5000/query/" + kennzeichen;

            console.log("Fetch " + url);

            fetch(url, { mode: "cors", credentials: "omit", referrerPolicy: "origin" })
                .then((response) => response.json())
                .then((data) => {
                    console.log(data);
                    var result = document.getElementById('kennzeichen_ergebnis');
                    result.innerHTML = data.kennzeichen;
                    var ts = document.getElementById('abfragezeitpunkt');
                    ts.innerHTML = new Date().toLocaleString('de-DE');
                })
                .catch((error) => {
                    console.error("Fetch fails:" + error);
                });
        });
    </script>

</body>

</html>